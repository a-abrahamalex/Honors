---
title: "Chutes and Ladders"
---

```{r}
coordinate = matrix(c(1:5, 10:6, 11:15, 20:16, 21:25),
                    nrow = 5, ncol = 5, byrow = T)
position = matrix(c(0), nrow = 5, ncol = 5, byrow = T)
dice = c() #runif(1, 0, 7)
numberOfSimulations = 1000
xValues = c()


# Enter Coordinate Values (1:25)
ladderTop = c(11,17,18,12)
ladderBottom = c(3,6,9,10)
chuteTop = c(14,19,24,22)
chuteBottom = c(4,8,16,20)

bounceBack = function(lastDiceRoll, initialPosition) {
  finalPosition = 50 - lastDiceRoll - initialPosition
  return(finalPosition) }


for(i in 1:numberOfSimulations) {
  dice = c()
  position = matrix(c(0), nrow = 5, ncol = 5, byrow = T)
  position[1] = 1
  
  while(position[which(coordinate == 25)] == 0) {
    # while the pawn is not at the last position
    
    # roll the dice
    dice = append(dice, round(runif(1, 0, 7)))
    while(dice[length(dice)] == 7 || dice[length(dice)] == 0) {dice[length(dice)] = round(runif(1, 0, 7))}
    
    # determine where the pawn is and where it should end up
    presentCoordinatePosition = coordinate[which(position == 1)]
    futureCoordinatePosition = presentCoordinatePosition + dice[length(dice)]
    # if the pawn moves past the 25th position, bounce back
    if(futureCoordinatePosition > 25) {futureCoordinatePosition = bounceBack(dice[length(dice)], presentCoordinatePosition) }
    
    # if the pawn lands on top of a chute (snake head), slide down to the bottom
    if(length(which(chuteTop == futureCoordinatePosition)) == 1) {futureCoordinatePosition = chuteBottom[which(chuteTop == futureCoordinatePosition)] }
    # if the pawn lands on the bottom of a ladder, climb to the top
    if(length(which(ladderBottom == futureCoordinatePosition)) == 1) {futureCoordinatePosition = ladderTop[which(ladderBottom == futureCoordinatePosition)] }
    
    position = matrix(c(0), nrow = 5, ncol = 5, byrow = T)
    position[which(coordinate == futureCoordinatePosition)] = 1 }
  
  xValues = append(xValues, length(dice)) 
  }

barplot(table(xValues)/numberOfSimulations, xlab = "Number of Dice Rolls", ylab = "Frequency", ylim = c(0,max(table(xValues)/numberOfSimulations)), main = "Frequency of Dice Rolls")
print(paste("The average number of dice rolls for", numberOfSimulations, "simulations is", round(mean(xValues)), "."))



```
